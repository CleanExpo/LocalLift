<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LocalLift Dashboard</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <meta name="description" content="LocalLift Dashboard - Manage your local business presence">
</head>
<body>
  <div id="root">
    <header class="bg-white shadow-sm">
      <nav class="container mx-auto px-4 py-3 md:flex md:items-center md:justify-between">
        <div class="flex items-center justify-between w-full md:w-auto">
          <div class="logo flex items-center">
            <i class="fas fa-chart-line text-primary-600 mr-2"></i>
            <h1 class="text-2xl font-bold text-gray-800">LocalLift</h1>
          </div>
          <div class="mobile-menu-toggle md:hidden">
            <div class="mobile-menu-icon"></div>
          </div>
        </div>
        <div class="nav-links mt-4 md:mt-0 space-x-6 hidden md:flex">
          <a href="/" class="font-medium hover:text-primary-600">Home</a>
          <a href="/dashboard" class="font-medium text-primary-600">Dashboard</a>
          <a href="/admin/guide" class="font-medium hover:text-primary-600">Guide</a>
<div class="dropdown">
  <a href="javascript:void(0)" class="btn btn-primary ml-4">Account</a>
  <div class="dropdown-content">
    <a href="/profile" class="dropdown-item">Your Profile</a>
    <a href="/settings" class="dropdown-item">Settings</a>
    <a href="javascript:void(0)" class="dropdown-item" id="logout-btn">Logout</a>
  </div>
</div>
        </div>
      </nav>
      <div class="mobile-nav md:hidden hidden">
        <a href="/" class="block px-4 py-2">Home</a>
        <a href="/dashboard" class="block px-4 py-2">Dashboard</a>
        <a href="/admin/guide" class="block px-4 py-2">Guide</a>
        <a href="/profile" class="block px-4 py-2">Your Profile</a>
        <a href="/settings" class="block px-4 py-2">Settings</a>
        <a href="javascript:void(0)" id="logout-btn-mobile" class="block px-4 py-2">Logout</a>
      </div>
    </header>
    
    <main>
      <section class="py-8 bg-gray-50">
        <div class="container mx-auto px-4">
          <h2 class="text-3xl font-bold mb-6">Business Dashboard</h2>
          
          <div class="grid md:grid-cols-3 gap-6">
            <div class="card hover:shadow-lg transition-shadow">
              <div class="text-center mb-4">
                <i class="fas fa-chart-line text-4xl text-primary-500"></i>
              </div>
              <h3 class="text-xl font-semibold mb-2 text-center">Performance Overview</h3>
              <p class="text-gray-600 text-center mb-4">View your business performance at a glance</p>
              <div class="api-status-container">
                <span class="api-status"></span> <span class="text-sm text-gray-500" id="api-status-text">Checking connection...</span>
              </div>
            </div>
            
            <div class="card hover:shadow-lg transition-shadow">
              <div class="text-center mb-4">
                <i class="fas fa-trophy text-4xl text-primary-500"></i>
              </div>
              <h3 class="text-xl font-semibold mb-2 text-center">Achievements</h3>
              <p class="text-gray-600 text-center mb-4">Track your business improvement progress</p>
              <div class="achievement-progress">
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 65%"></div>
                </div>
                <p class="text-sm text-gray-500 mt-2">65% complete</p>
              </div>
            </div>
            
            <div class="card hover:shadow-lg transition-shadow">
              <div class="text-center mb-4">
                <i class="fas fa-file-alt text-4xl text-primary-500"></i>
              </div>
              <h3 class="text-xl font-semibold mb-2 text-center">Reports</h3>
              <p class="text-gray-600 text-center mb-4">Generate and view your business reports</p>
              <button id="generate-report-btn" class="btn btn-primary w-full">Generate Report</button>
            </div>
          </div>
        </div>
      </section>
      
      <section class="py-8 bg-white">
        <div class="container mx-auto px-4">
          <h2 class="text-3xl font-bold mb-6">Recent Activity</h2>
          
          <div class="card mb-6">
            <div class="mb-4">
              <h3 class="text-xl font-semibold">Weekly Engagement Report</h3>
              <p class="text-gray-600">Your customer engagement is up 12% from last week</p>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg">
              <div class="graph-placeholder" style="height: 200px; background-color: #f9fafb; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center;">
                <canvas id="engagement-chart" style="width: 100%; height: 100%;"></canvas>
              </div>
            </div>
          </div>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div class="card">
              <h3 class="text-xl font-semibold mb-4">Upcoming Tasks</h3>
              <ul class="space-y-2">
                <li class="flex items-center p-2 bg-gray-50 rounded">
                  <i class="fas fa-check-circle text-green-500 mr-2"></i>
                  <span>Update business profile</span>
                </li>
                <li class="flex items-center p-2 bg-gray-50 rounded">
                  <i class="fas fa-circle text-gray-300 mr-2"></i>
                  <span>Schedule social media posts</span>
                </li>
                <li class="flex items-center p-2 bg-gray-50 rounded">
                  <i class="fas fa-circle text-gray-300 mr-2"></i>
                  <span>Review customer feedback</span>
                </li>
              </ul>
            </div>
            
            <div class="card">
              <h3 class="text-xl font-semibold mb-4">Latest Notifications</h3>
              <ul class="space-y-2">
                <li class="p-2 bg-gray-50 rounded">
                  <p class="font-medium">New customer review received</p>
                  <p class="text-sm text-gray-500">2 hours ago</p>
                </li>
                <li class="p-2 bg-gray-50 rounded">
                  <p class="font-medium">Weekly report generated</p>
                  <p class="text-sm text-gray-500">Yesterday</p>
                </li>
                <li class="p-2 bg-gray-50 rounded">
                  <p class="font-medium">Achievement unlocked: 50 customers</p>
                  <p class="text-sm text-gray-500">3 days ago</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>
    </main>
    
    <footer class="bg-gray-800 text-white py-10">
      <div class="container mx-auto px-4">
        <div class="grid md:grid-cols-3 gap-8 mb-8">
          <div>
            <h3 class="text-xl font-semibold mb-4">LocalLift</h3>
            <p class="text-gray-400">Helping local businesses thrive in the digital age with powerful analytics and engagement tools.</p>
          </div>
          <div>
            <h3 class="text-xl font-semibold mb-4">Quick Links</h3>
            <ul class="space-y-2">
              <li><a href="/" class="text-gray-400 hover:text-white">Home</a></li>
              <li><a href="/dashboard" class="text-gray-400 hover:text-white">Dashboard</a></li>
              <li><a href="/admin/guide" class="text-gray-400 hover:text-white">Guide</a></li>
            </ul>
          </div>
          <div>
            <h3 class="text-xl font-semibold mb-4">Support</h3>
            <p class="text-gray-400 mb-2"><i class="fas fa-envelope mr-2"></i> support@locallift.com</p>
            <p class="text-gray-400"><i class="fas fa-phone mr-2"></i> (555) 123-4567</p>
          </div>
        </div>
        <div class="border-t border-gray-700 pt-6 text-center">
          <p class="text-gray-400">&copy; 2025 LocalLift. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </div>
  
  <script src="../js/config.js"></script>
  <script src="../js/main.js" defer></script>
  <script>
    // Dashboard-specific JavaScript
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Dashboard initialized');
      // Mobile menu toggle functionality
      const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
      const mobileNav = document.querySelector('.mobile-nav');
      if (mobileMenuToggle && mobileNav) {
        mobileMenuToggle.addEventListener('click', function() {
          mobileNav.classList.toggle('hidden');
        });
      }
      
      // Check API connection
      const apiStatusText = document.getElementById('api-status-text');
      const apiStatus = document.querySelector('.api-status');
      
      window.addEventListener('api-status-updated', function(event) {
        if (event.detail.connected) {
          apiStatusText.textContent = 'API connected';
          apiStatus.classList.add('connected');
        } else {
          apiStatusText.textContent = 'API connection issue';
          apiStatus.classList.add('error');
        }
      });
      
      // Initialize with API status check
      setTimeout(function() {
        if (window.LOCALLIFT_CONFIG) {
          const API_BASE = window.LOCALLIFT_CONFIG.API_BASE_URL || 'http://localhost:8000';
          const apiUrl = `${API_BASE}/api/health`;
          
          fetch(apiUrl, {
            method: 'GET',
            headers: { 'Accept': 'application/json' },
            credentials: 'include'
          })
          .then(response => {
            if (response.ok) {
              window.dispatchEvent(new CustomEvent('api-status-updated', { 
                detail: { connected: true }
              }));
            } else {
              window.dispatchEvent(new CustomEvent('api-status-updated', { 
                detail: { connected: false }
              }));
            }
          })
          .catch(error => {
            console.error('API check failed:', error);
            window.dispatchEvent(new CustomEvent('api-status-updated', { 
              detail: { connected: false }
            }));
          });
        }
      }, 1000);

      // New functionality for generating report
      const generateReportBtn = document.getElementById('generate-report-btn');
      if (generateReportBtn) {
        generateReportBtn.addEventListener('click', function() {
          const API_BASE = window.LOCALLIFT_CONFIG.API_BASE_URL || 'http://localhost:8000';
          const reportUrl = `${API_BASE}/api/reports/generate`;
          fetch(reportUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json'
            },
            credentials: 'include'
          })
          .then(response => {
            if (!response.ok) {
              throw new Error("Report generation failed");
            }
            return response.json();
          })
          .then(data => {
            alert("Report generated: " + (data.message || "Report created successfully"));
          })
          .catch(err => {
            console.error(err);
            alert("Error generating report");
          });
        });
      }

      // Initialize engagement chart if available
      const engagementChartCanvas = document.getElementById('engagement-chart');
      if (engagementChartCanvas) {
        if (typeof Chart !== 'undefined') {
          const ctx = engagementChartCanvas.getContext('2d');
          new Chart(ctx, {
            type: 'line',
            data: {
              labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
              datasets: [{
                label: 'Engagement',
                data: [12, 19, 3, 5, 2, 3, 7],
                backgroundColor: 'rgba(0, 118, 255, 0.2)',
                borderColor: 'rgba(0, 118, 255, 1)',
                borderWidth: 1
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false
            }
          });
        } else {
          console.warn("Chart.js library is not loaded. Engagement chart is not available.");
        }
      }
    });
  </script>
  
  <style>
    /* Dashboard-specific styles */
    .achievement-progress {
      margin-top: 1rem;
    }
    
    .progress-bar {
      height: 0.5rem;
      background-color: #e5e7eb;
      border-radius: 9999px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background-color: var(--color-primary-500);
      border-radius: 9999px;
    }
    
    .api-status-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 1rem;
    }
    
    .graph-placeholder {
      border: 1px dashed #d1d5db;
    }
    /* Additional layout enhancements */
    .mobile-menu-toggle {
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .mobile-menu-icon {
      width: 25px;
      height: 3px;
      background-color: #1d4ed8;
      border-radius: 2px;
    }
    .mobile-nav a {
      padding: 10px 15px;
      border-bottom: 1px solid #e5e7eb;
    }
    header {
      position: sticky;
      top: 0;
      background-color: #ffffff;
      z-index: 1000;
    }
    /* Enhanced Layout */
    main {
      padding: 20px 0;
      max-width: 1200px;
      margin: 0 auto;
    }
    nav a {
      padding: 10px 20px;
    }
    .card {
      transition: transform 0.3s;
    }
    .card:hover {
      transform: scale(1.02);
    }
    </style>
</body>
</html>
